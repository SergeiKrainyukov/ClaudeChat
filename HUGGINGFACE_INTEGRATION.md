# Интеграция Hugging Face моделей

## Обзор

В приложение интегрирована функциональность сравнения двух моделей Hugging Face. Это позволяет отправить один запрос двум разным моделям и сравнить их ответы по качеству и времени отклика.

## Установка и настройка

### 1. Получение API ключа Hugging Face

1. Зарегистрируйтесь на [Hugging Face](https://huggingface.co/)
2. Перейдите в настройки: https://huggingface.co/settings/tokens
3. Создайте новый Access Token (рекомендуется тип "Read")
4. Скопируйте полученный токен

### 2. Добавление API ключа в приложение

Откройте файл `app/src/main/java/com/example/claudechat/api/ApiKeys.kt` и добавьте ваш API ключ:

```kotlin
object ApiKeys {
    const val ANTHROPIC_API_KEY = "ваш_ключ_anthropic"
    const val HUGGING_FACE_API_KEY = "ваш_ключ_huggingface"
}
```

**ВАЖНО:** Этот файл не должен попадать в git (он уже добавлен в .gitignore).

## Архитектура

### Созданные компоненты

1. **API слой**
   - `HuggingFaceModels.kt` - модели данных для запросов/ответов
   - `HuggingFaceApiService.kt` - Retrofit интерфейс
   - `HuggingFaceApiClient.kt` - клиент для работы с API

2. **Репозиторий**
   - `HuggingFaceRepository.kt` - логика работы с моделями

3. **ViewModel**
   - `ModelComparisonViewModel.kt` - управление состоянием сравнения

4. **UI**
   - `ModelComparisonScreen.kt` - экран сравнения моделей

## Использование

### Через приложение

1. Запустите приложение
2. На главном экране выберите "Сравнение моделей"
3. Введите запрос в текстовое поле
4. Нажмите "Сравнить модели"
5. Дождитесь результатов от обеих моделей
6. Изучите сравнительную таблицу

### Настройка моделей

По умолчанию используются модели:
- **Модель 1:** `google/flan-t5-small` - T5 модель от Google (60M параметров)
- **Модель 2:** `facebook/opt-125m` - OPT модель от Meta (125M параметров)

**ВАЖНО:** Используйте полные ID моделей с указанием организации! Старые короткие ID (типа `gpt2`, `distilgpt2`) могут не работать.

Вы можете изменить модели в `ModelComparisonViewModel.kt`:

```kotlin
private var model1Id = "google/flan-t5-small"
private var model2Id = "facebook/opt-125m"
```

Список рекомендуемых моделей смотрите в файле `HUGGINGFACE_MODELS.md`.

### Рекомендуемые модели для сравнения

#### Легкие модели (быстрые, для тестирования)
- `gpt2` - базовая GPT-2 (117M параметров)
- `distilgpt2` - облегченная GPT-2 (82M параметров)
- `facebook/opt-125m` - OPT модель от Meta

#### Средние модели
- `EleutherAI/gpt-neo-1.3B` - GPT-Neo 1.3B
- `facebook/opt-1.3b` - OPT 1.3B

#### Модели для диалога
- `microsoft/DialoGPT-medium` - специализирована на диалогах
- `facebook/blenderbot-400M-distill` - чат-бот от Meta

**Примечание:** Более крупные модели могут требовать больше времени для загрузки при первом запросе (модель "прогревается" на сервере Hugging Face).

## Структура ответа

Каждая модель возвращает:
- **Текст ответа** - сгенерированный текст
- **Время ответа** - в миллисекундах
- **Название модели** - для идентификации
- **Ошибка** (если есть) - описание проблемы

## Сравнение показывает

1. **Скорость ответа** - какая модель быстрее
2. **Длину ответа** - количество символов
3. **Качество текста** - визуальное сравнение

## Возможные проблемы

### Модель загружается долго

Некоторые модели на Hugging Face Inference API "засыпают" и требуют времени на первую загрузку (до 20-30 секунд). Последующие запросы будут быстрее.

### Ошибка "Model is currently loading"

Подождите несколько секунд и повторите запрос.

### Ошибка авторизации

Проверьте, что API ключ правильно добавлен в `ApiKeys.kt`.

### Превышен лимит запросов

Бесплатный план Hugging Face имеет ограничения на количество запросов в минуту. Подождите немного перед следующим запросом.

## Расширение функциональности

### Добавление новых моделей

Чтобы добавить возможность выбора моделей в UI:

1. Создайте список доступных моделей
2. Добавьте Dropdown меню в `ModelComparisonScreen.kt`
3. Используйте `viewModel.setModels(model1, model2)` для установки

### Сравнение большего количества моделей

Можно расширить функционал для сравнения 3+ моделей:

1. Модифицируйте `HuggingFaceRepository.kt`
2. Обновите `ModelComparisonViewModel.kt`
3. Адаптируйте UI для отображения большего количества результатов

## API документация

- [Hugging Face Inference API](https://huggingface.co/docs/api-inference/index)
- [Список доступных моделей](https://huggingface.co/models?pipeline_tag=text-generation)

## Лицензия и использование

При использовании моделей Hugging Face учитывайте лицензии каждой модели. Большинство моделей доступны для исследовательских целей, но проверьте конкретную лицензию перед коммерческим использованием.
